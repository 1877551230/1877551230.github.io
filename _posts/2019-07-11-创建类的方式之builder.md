---
layout:     post
title:      创建类的方式之builder
subtitle:   
date:       2019-07-11
categories: Java
author:     miracle
catalog: true
tags:
    - Java基础
---

* content
{:toc}
一般来说创建类的方式有三种:

1. 构造器创建

直接通过 类名 名字 = new 类名(参数) 的方式

2. 工厂方法创建:通过传入字符串的方式

```java
public static Person person(String type){
		person p = null;
		if("comm".equals(type)){
			ie = new CommonEmployee();
		}else if("sale".equals(type)){
			ie = new SaleEmployee();
		}else if("manager".equals(type)){
			ie = new ManagerEmployee();
		}
		return ie;
	}
```

3. builder方式

```java
public class Person {
	//姓名 -required(必写)
	private final String name;
	//性别-required(必写)
	private final String gender;
	//年龄
	private int age;
	//省份证号
	private String id;
	
	public static class newBuilder{
		//姓名 -required
		private String name;
		//性别-required
		private String gender;
		//年龄
		private int age;
		//省份证号
		private String id;
		
		public newBuilder setAge(int age){
			this.age = age;
			return this;
		}
		public newBuilder setId(String id){
			this.id = id;
			return this;
		}
		public newBuilder(String name,String gender){
			this.name = name;
			this.gender = gender;
		}
		public Person build(){
			return new Person(this);
		}
	}
	//外部类的私有构造函数
	private Person(newBuilder builder){
		this.name = builder.name;
		this.gender = builder.gender;
		this.age = age;
		this.id = id;
	}

}
```

创建对象时

```java
Person p = new Person.newBuilder("miracle","male").setAge(18).build();
Person p = new Person.newBuilder("miracle","male").setAge(18).setId("1877551230").build();
```

### 思路

* 我们用builder方式创建对象时,用到了静态的内部类,内部类可以访问外部类的所有属性和方法  
* 为外部类写一个私有的构造方法,就不能直接用外部类用new的方式来创建对象
* 所以用外部类打点内部类的方式先new出内部类对象,通过设置内部类的构造方法限定必须要输入的属性值;然后用内部类调用build()方法,返回一个以子类作为参数的Person类类型,内部类就通过私有的外部类构造器创建了一个新的对象
* 因为子类set方法的返回值都是子类的类类型,所以可以继续设置属性

### 优点

* 成员变量可以是final类型,通过设置构造函数来要求必须输入
* 对象状态连续,创建时就赋值,更加清晰

### 总结

* 外部类构造函数私有,且参数为静态内部类,使用静态内部类的变量为构建类逐一赋值
* 静态内部类拥有外部类相同的属性
* 为每一个属性写一个setter方法,返回的是当前Builder对象
* 最后提供一个方法build方法,new出来一个构建类的对象,参数是当前的Builder对象